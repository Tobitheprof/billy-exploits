import requests

class SupabaseClient:
    def __init__(self, base_url):
        self.base_url = base_url

    def get_profiles(self, api_key):
        """Send a GET request to retrieve profiles from the Supabase API."""
        url = f"{self.base_url}/rest/v1/profiles?apikey={api_key}"
        response = requests.get(url)

        if response.status_code == 200:
            return response.json()  # Return the JSON response
        else:
            raise Exception(f"Failed to retrieve profiles: {response.status_code} - {response.text}")

# Example usage
if __name__ == "__main__":
    # Define the base API URL
    base_url = "https://kzwchxoppyozdxucvqmw.supabase.co"
    api_key = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt6d2NoeG9wcHlvemR4dWN2cW13Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjIxOTA0NDAsImV4cCI6MjAzNzc2NjQ0MH0.hvDgNLnoPRmoljefQ81OldsZ9imNuPuDToQkgYY0sVc"

    # Create an instance of SupabaseClient
    client = SupabaseClient(base_url)

    try:
        # Call the method to get profiles
        profiles = client.get_profiles(api_key)
        print("Retrieved Profiles:")
        print(profiles)  # Print the JSON response from the server
    except Exception as e:
        print(str(e))
